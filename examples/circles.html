<html>
  <head>
    <link href="common/examples.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <div id="game">
      <canvas id="example" width="800" height="600"></canvas>
    </div>
    
    <script type="text/javascript" src="../build/timber.js"></script>
    <script type="text/javascript" src="common/jquery-1.6.2.js"></script>
    <script type="text/javascript">
$(document).ready(function () {


    var engine = new timber.Engine("example");
    var logger = new timber.Logger("app");

    var f = true;

    var addNew = function () {
        var p = new timber.Point(0, 0);

        var dx = Math.random() + 0.8;
        var dy = Math.random() + 0.2;
        var d = new timber.Vector(dx, dy).normalize();

        var s = Math.random();
        var s2 = Math.random();

        var w = Math.random() * 20 + 50;
        var h = Math.random() * 10 + 50;
        var r = Math.random() * 50 + 10;

        var circle = new timber.Circle(p, d, s, r);
        var rectangle = new timber.Rectangle(p, d, s2, w, h);

        if (f) {
            engine.add(circle);
        } else {
            engine.add(rectangle);
        }
        f = !f;

        window.c = engine.canvas.context;
    };

    var handleKeypress = function (event) {
        var key = (event.which) ? event.which : e.keyCode;
        logger.debug("keypress: " + event.which);

        if (key === 78) {
           addNew();
        } else if (key === 81) {
            engine.stop();
        } else {
          
            // Scatter the circles.
            var x, y;
            for (var i=0; i<engine.elements.length; i++) {
              do {
                x = Math.random() * 2 - 1;
                y = Math.random() * 2 - 1;
              } while (x === 0 || y === 0);

              var d = new timber.Vector(x, y).normalize();
              engine.elements[i].direction = d;
              engine.elements[i].speed = Math.random() * 3;
            }
        }
    };

    $(document).keydown(handleKeypress);
    engine.start();

});
  </script>
    
  </body>
</html>
  
